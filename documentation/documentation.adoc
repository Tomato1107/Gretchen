:imagesdir: ./images
:toc:

= Gretchen Assembly Documentation

This is the Gretchen assembly manual. Following these steps will enable you to build your humanoid robot from the assembly kit.

=== Tool and Part List
Before starting the assembly. Check that you have all the tools and parts in place.


== Recommended Tools

You will need these tools to assemble the Gretchen robot.

* Allen keys (hex drivers)
** M1.6 (bearing set screws)
** M2   (belt tensioners)
** M4   (motors and bearings)

* Ring spanner M8 for joints
* Small Phillips screw driver
* Soldering iron with a fine tip for motor assembly
* Brushes for painting the parts
* Tweezers for motor control board assembly
* Flat-nosed pliers or a crimp tool for custom cabling

* Sandpaper or files
* Clamps (5-10) for glueing parts together

* Acrylic paint (< 0.5mÂ², color of your choice)
* Acrylic clear coat

*For self-manufacturing the body parts:*

* Lab or home quality 3D printer, e.g. Ultimaker using ABS or tough PLA filament
* Laser cutting or milling machine for the wooden parts



== 3D Printed parts

* 10x Tooth Belt Pulleys with DSpline connector
* 2x Tooth Belt Pulleys with M8 Hex nut connector
* 2x hip axel connector with integrated pulleys
* 2x knee inner (L/R)
* 2x knee outer (L/R) with integrated pulleys
* 2x foot (L/R)
* 2x ankle cardan gimbal
* 2x Tooth Belt Pulleys for 4x M4 screws connector
* *TODO:*

*For self-manufacture your robot's body parts:*

Home or Lab Quality printers shall suffice. Print with "Tough" PLA or ABS Plastic using 20% infill for the parts.
Print using 0.1 mm layer height for parts that contain pulleys (tooth belts need precision here). Print using 0.2 mm layers for all other parts. We recommend using water soluble support structure if available.

When using professional 3D-printing service, consider SLS (Selective Laser Sintering).


== Laser Cut parts

== Mechanical Standard parts

== Electronic parts

* 10x Sensorimotors
* 10x Servo Motors Hitec HS-805MG
* Acceleration Sensor (ADXL345) Breakout board GY-291
* 2x Termination Resistor 220 Ohm
* Cables according to the list below

=== Cable lengths

[cols=2*,options=header]
|===
| Name          | Length
| thigh-2-shank | 42cm
| shank-2-foot  | 38cm
| hip-2-thigh   | 42cm
| hip-2-hip     | 16cm
| thigh-2-thigh | 16cm
|===


== Glueing

The wooden parts are approx. 5mm thick. Each Gretchen body part (lower torso, thigh or shank) is composed of two 5mm wooden plates glued together to reach the 10mm needed. Hence, in your assembly kit you should have 4x shank, 4x thigh, 2x torso plates.

image::lasercut_parts.jpg[]

=== Prepare workbench.
Make sure you have all the tools needed for glueing:

* a lot of clamps (5 - 10 small clamps)
* Sandpaper or fine file
* small screwdriver
* cutter knife
* express wood glue

image::prepare_workbench_and_tools.jpg[]

=== Prepare the wood parts for glueing.
Gently remove the remaining loose parts and price stickers, if any present. Depending on the laser cut depth, it may appear that remaining parts (clippings) must be removed carefully with a cutter knife or sandpaper.

Approximated time needed: 5 - 10 minutes

image::remove_loose_parts.jpg[]
image::remove_stickers.jpg[]

=== Glue the parts together.
Glue the parts together preferably using express wood glue. Apply glue uniformly following the recommendations of the specific glue user manual.

image::apply_glue_uniformly.jpg[]
image::ready_for_glueing.jpg[]

Use many small clamps to apply appropriate pressure distributed on the full surface. Use some of M4 screws to hold the parts in place and assure that the parts are nicely aligned before the glue gets dry.

image::clamping_parts.jpg[]
image::align_and_fix_with_screw.jpg[]

Let the assembly dry for some time with the clamps attached. Follow specific instructions depending on the glue you are using. Remove remaining glue _after_ drying. Since otherwise smeared adhesive on the wood parts can not be painted well.

image::excessive_glue.jpg[]

Glueing takes approximately *10 - 15* minutes per part. But drying will probably take *1 - 2* hours depending on the glue you are using. Repeat the process for all wooden parts, i.e. one lower torso, two thighs, two shanks.

The result should look like this:

image::glue_result.jpg[]

== Coloring

Color is of course optional but gives your Gretchen an individual character. Nonetheless it is recommended to apply some clear coat to protect the wooden parts from humidity and fat.

image::coloring_parts_start.jpg[]

=== Paint the parts
We recommend coloring the surfaces of the wooden parts and leave the nicely burned laser cut edges unpainted.

image::coloring_parts_doing.jpg[]

For instance we painted the outer surfaces orange and the inner surfaces antrazit.

image::coloring_parts_orange.jpg[]
image::coloring_parts_antrazit.jpg[]

In the end it could look like this:

image::coloring_parts_ready.jpg[]

=== Applying clear coat

After coloring or coating the wooden parts for the first time, little bristles come up and the surface feels very rough and bristly.
Before finishing with the last coating layer, carefully use sandpaper to make the surface smooth without removing the color.

image::coloring_parts_clearcoat.jpg[]

== Assembly

Assembly is done in several steps. Although there are many possible ways to assemble, we recommend the order given in the manual.

=== Bearings

We begin the assembly with mounting the bearings. You need:

* all five wooden parts
* 16 bearings KFL08
* 16 screws M4 x 25 mm
* 16 lock nuts M4
* 32 spring washers M4
* an M4 hex screw driver and complementary a spanner

Note: If you consider to use an electric screw driver we recommend using torque control.

image::prepare_bearing_mounting.jpg[]

Before starting, make sure to remove remaining glue from the screw holes. Use a drill or hex screw driver to remove the dried glue.

image::remove_glue_in_holes.jpg[]

The bearings are self-aligning, i.e. they can change their axes' direction. Bearings must be properly aligned, to guarantee a solid belt tension later. You should initially move the bearings once to slightly loosen the connection and more easily correct the alignment.

image::centering_bearings.jpg[]

Mount the bearings on both sides (dual bearing) using the M4 x 25 mm screws as shown in the picture. You should only tighten the screws loosely in the first place and than correct the axis to be perpendicular to the surface.

image::assemble_loosly.jpg[]

Check the proper rotation of the axes.

image::check_bearing.jpg[]

After proper centering the bearing, tighten screws. The final result should look like this.

image::bearing_mounted_0.jpg[]

image::bearing_mounted_1.jpg[]

image::bearing_mounted_finished.jpg[]


=== Knee

The next step is mounting the knees. Prepare workbench by compiling the needed parts (per knee):

* shank with bearings
* knee inner
* knee outer (with integrated tooth belt pulley)
* 2x M4 x 40 mm screws
* 1x M4 x 30 mm screw

Tools:

* (electric) screwdriver,
* clamp (optional),
* M5 drill (optional)

image::prepare_mounting_knee.jpg[]

Insert the 3 screws into the outer knee part (with pulley). Insert only as deep as the screw tips are barely visible, just enough to find the corresponding hole in the wooden part.

image::knee_mounting_0.jpg[]

Screw the two parts together. Probably pressing the part down to the workbench might help to get the screws inserted. Again, turn only as far as the tips of the screws are barely visible.

image::knee_mounting_1.jpg[]

Carefully sinking the holes of the inner side of the second plastic part with a drill of size 5mm will help the screws _finding_ the holes. Sink less than 1mm.

image::knee_mounting_sink_hole.jpg[]

Mount the second part, optionally using a clamp, to have the parts perfectly aligned. Since there are no dedicated nuts here, don't turn to fast and powerful, the screw will create their own thread into the plastic, which must be preserved.

image::knee_mounting_2.jpg[]

After mounting the knee, the result should look like this. Again, don't overturn here. Use torque limiter on your electric screwdriver.

image::knee_mountin_ready_0.jpg[]

Repeat the process with the second knee.

image::knee_mountin_ready_both.jpg[]


=== Hip

Always remember: *Easy does it. Don't push too hard.* In German: "Nach fest kommt ab." (After firmly comes off.)


==== Assemble Hex Nut Pulleys
Prepare workbench for assembly, you need the both pulleys and 2 hex nuts with flat form. Depending on the print tolerances you either need addionally a *clamp* for adding a little force to insert or need some *express glue* to keep the hex nut in place, if it is too loose.

image::prepare_hex_nut_pulley.jpg[]

This is how the hex nut should be inserted.

image::hex_nut_inserted_into_pulley.jpg[]

If the pocket is too tight, use the clamp for insertion. If it is too loose use a little drop of express glue to keep it in place.

image::forcing_hex_nut_insertion_with_clamp.jpg[]

==== Inserting the bolts' threading into pulley
Next step is to cut the threading into the pulleys.

image::prepare_hex_nut_pulley_bolt_insertion.jpg[]

If you have an M8 threading drill at hand, use this, otherwise use the M8 screw directly to cut the threading. Always begin with the cutting from the nut side, in order to assure a continuos threading between nut and plastic.
Using the wrench for cutting will need a little power, so prepare for the turning to need a little more torque than usual.

image::hex_nut_pulley_threading_with_drill.jpg[]

image::hex_nut_pulley_threading_with_bolt.jpg[]

Insert the bolt from the other side and repeat the process for the second pulley.

image::hex_nut_pulleys_with_bolts_ready.jpg[]

Remove remaining overextruded plastic or sharp edges using sand paper or cutter.

image::clean_sand_hip_parts.jpg[]

Check for clean and even pockets and glue the nuts into the pockets using express glue. Probably check the nut for good quality to guarantee a perpendicular bolt alignment.

image::glue_nuts_into_pockets.jpg[]

Use clamps while let drying the glue.

image::use_clamps_to_dry_glued_nuts.jpg[]

As before use the threading drill carefully with limited torque.

image::drill_threading_hip_part.jpg[]

Turning bolts into threading holes should be moderately easy, otherwise check threading.
Again, always drill using the nut to assure a continouosly cutted threading.

image::check_hole_depth.jpg[]

The holes should be around 15 mm in depth. Check with the bolt and some removable tape for instance.

image::prepare_tools_workbench_hip_assembly.jpg[]

Get all tools and parts ready for assembly.
Turn one of the nuts onto the bolt with the pre-assembled pulley and lock it to the nut in the hex pocket to form a solid connection with the bolt (locking nut).

image::tighten_M8_nut_on_hip.jpg[]

Insert the distance washer and thigh as depicted below and finally add the hip axel connector (also using a nut for locking).
The normal washer must be inserted to the outer side (lower profile) and the spring washer to the inner side. The spring washer is just for eating up the free space preventing play and should not be tensed. Check this with turning the axis, if it feels spongy then the spring washer is tensed too much.

image::hip_result_using_washers_for_distance.jpg[]

Repeat with the second hip accordingly.

=== Foot


=== Motors

Prepare workbench and get all the needed tools.

image::desolder_tools.jpg[]

==== Remove servo controller.

See some videos for a quick overview. Read text and see images below for detailed step by step explanations on how to desolder the servo motors printed circuit boards and install the Sensorimotors.


video: https://www.youtube.com/watch?v=jpkWSJoK_m4[sensorimotor_assembly_01_removing_old_controller]

video::jpkWSJoK_m4[youtube]

video:  https://www.youtube.com/watch?v=5hQtV_ZHUZk[sensorimotor_assembly_02_desoldering_detail]

video::5hQtV_ZHUZk[youtube]

Secure the gearbox with some removable tape.

image::tape_motorbox.jpg[]

Unscrew the six housing screws and remove the cover and keep the screws separately (we will need them later).

image::unscrew_motor_cover.jpg[]

Stabilize the motor using a clamp or similar.
Use a desolder pump to remove solder from the motor pins.
Consider using a higher soldering temperature (e.g. 410Â°C) since the (power-)pads will sink a lot of heat. And depending on the soldering station/iron you are using this may drop the temperature on the tip of the iron a little below melting piont, and thus makes desoldering hard. We recommend to always add flux or add a little fresh solder (which has flux included) to make desoldering easier.

image::desolder_motorpins.jpg[]
image::desolder_motorpins_result_commented.jpg[]

Heat up the grounding pin and lift the board with a pointed tool while continuing heating. The grounding pin either remains at the motor case or on board side, no matter remove it or leave it for later use.
The grounding pin will sink excessive heat, so be patient and use enough heat and time to thoroughly melt the solder.

image::desolder_grounding_pins.jpg[]

Cut the red, yellow and green cable very close to the boards and remove the board, be carefull the edges of the board may be hot due to heaten up ground layer which is going close to the edges.

image::cut_cables_and_remove_board.jpg[]

Remove any loose solder remainings carefully. Use vacuum cleaner if needed. Remove any loose glue remaining. Recycle or archive the boards, covers and accessoires, since we do not need them anymore. Keep the screws, will be needed later.

image::motorboard_removal_complete.jpg[]

Repeat the process for all motors.

image::all_motors_ready.jpg[]

==== Assemble Sensorimotor Board

video:  https://www.youtube.com/watch?v=D0k9pQJAyEo[sensorimotor_assembly_03_soldering_through_hole_parts]

video::D0k9pQJAyEo[youtube]

Get the 10 sensorimotor board and the through hole parts which need to be soldered.

image::get_sensorimotors.jpg[]
image::sensorimotor_through_hole_parts.jpg[]

Get all the needed and recommended tools. Use a fine solder tip and thin solder for the best quality. Set solder temperature a little above recommended for compensating the heat sink due to power pads.

image::sensorimotor_tools_needed.jpg[]
image::sensorimotor_recommended_solder_tools.jpg[]
image::sensorimotor_recommended_fine_pitch_solder_tip.jpg[]

Insert the Motorcord (RS485, 4-pin, white, rectangluar) sockets and the I2C connector (black) from top side and solder from bottom side. Check for clearly separated pins.

image::sensorimotor_insert_sockets.jpg[]
image::sensorimotor_check_solder_pins.jpg[]

Insert and solder the ISP 6-pin header next. You can use the capacitor to balance the board.

image::sensorimotor_solder_ISP_header.jpg[]
image::sensorimotor_check_ISP_pins.jpg[]

Bend the two pins of the thermistor (TO92 housing) by 90 degrees and solder to the bottom of the board, the thermistor body should be placed left below the H-bridge with the flat side close to the surface.

image::sensorimotor_bend_thermistor.jpg[]
image::sensorimotor_solder_thermistor.jpg[]

Insert the electrolytic capacitor from bottom side, check for correct polarity and solder. The negative (GND) pin will be sinking a lot of heat because it is directly connected to a large ground plane, be prepared for this taking some more seconds for the solder/pad to reach the melting temperature. Cut/remove the remaining material close to the board

image::sensorimotor_insert_polarized_capacitor.jpg[]
image::sensorimotor_remove_remaining_pin.jpg[]

Repeat the process for all sensorimotor boards.

image::sensorimotor_ready_1.jpg[]



==== Installing Sensorimotor into Servo

video:  https://www.youtube.com/watch?v=W5wTd_JIoqk[sensorimotor_assembly_04_prepare_cover]

video::W5wTd_JIoqk[youtube]

video:  https://www.youtube.com/watch?v=vMh9dKeaUrc[sensorimotor_assembly_05_installing board]

video::vMh9dKeaUrc[youtube]

Get all the tools and prepare workbench for installation.

image::tools_for_installing_sensorimotor.jpg[]

Check if cover fits to the servo box, remove any remaining support material or grain. Check if Sensorimotor board fits into cover frame.

image::check_cover_fits_on_motorbox.jpg[]
image::check_sensorimotor_fits_into_cover.jpg[]

Strip the wires of the potentiometer, twist/focus the wires' ends with your finger tips and pre-solder the wires to best fit into solder holes.

image::strip_wires_of_potentiometer.jpg[]
image::potentiometer_wires_pre-soldered.jpg[]

Solder potentiometer pins in the shown order! Be careful, the cables' isolation may melt (and then retract) quickly. Cut the cables' ends close above the board.

image::solder_potentiometer_pins.jpg[]

Cut, strip and pre-solder the motor wires, approximately 5cm each.

image::motor_wires_5cm.jpg[]

Solder the motor wires and the grounding cable in the shown order. Soldering the ground cable to the motor shielding is sinking much heat, this will probably require to give your soldering station a boost (e.g. I use to solder this cable with 450Â°C).
Attention: We recommend to use shrinking tubing to isolate the motor pins here, since the cables will be very close to each other and short circuits are otherwise very likely.

image::solder_motor_wires.jpg[]

Bend the motor wires carefully to fit below the board and push down the cables, check if everything will fit.

image::bend_motor_wires.jpg[]
image::bend_motor_wires_2.jpg[]
image::push_down_cables_carefully.jpg[]

Mount the 3D-printed plastic cover on the boards and install the screws.

image::mount_cover_to_motorbox.jpg[]

This is how the motor should look like when fully assembled.

image::sensorimotor_fully_assembled_with_servo.jpg[]

Use the multimeter to check for potential short circuits on every recently soldered connections visible from the top side (i.e. check resistance, most devices will bleep when there is no sufficient resistance.) Between the motor connections there should be a low resistance, since you checking for the motor coil. All other connections must be free of short circuits.

image::shortcircuit_check.jpg[]

Repeat the process for the rest of the motors.

image::sensorimotors_finished.jpg[]

Get some labels with the motors' IDs and put them on each individual motor.

image::label_motor_ids.jpg[]

=== Flashing Firmware

TODO

video:  https://www.youtube.com/watch?v=vXhYqfAI-04[sensorimotor_assembly_06_test_and_setting_fuses]

video::vXhYqfAI-04[youtube]

image::sensorimotor_flashing_firmware.jpg[]

=== Setting Motors IDs

Get the tools and cables needed to set the motors's IDs.

image::tools_for_setting_motor_id.jpg[]

image::connect_interface_for_pc_motor_com.jpg[]

To set the motors IDs connect motors to the RS-485-to-USB adapter, one after another, each motor separately. Go to the tools directory and find the python script called `set_id.py`.

Run the python script
....
python set_id.py
....
in any terminal or
....
./set_id.py
....
in your Linux shell to scan for motor ids. Motors which do not yet have an ID set are set by default to `127`.
To set a motor's ID, specify the board number with `-b 127`, (127 in case the motor was never given an ID or firmware was updated and ID erased) and specify new ID `-n 7` e.g. if you desired new motor ID shall be `7`

....
./set_id.py -b 127 -n 7
....

video: https://www.youtube.com/watch?v=aV9UtVvDbz4[sensorimotor_assembly_08_setting_individual_motor_ids]

video::aV9UtVvDbz4[youtube]


Repeat for all motors and finally check if all IDs were successfully set.

image::motors_respond_to_ping.png[]

video: https://www.youtube.com/watch?v=CWDaAJ0dNk8[sensorimotor_assembly_09_checking_all_motors_ids]

video::CWDaAJ0dNk8[youtube]


=== Assemble the Legs

Get all the tools and parts.

image::parts_and_tools_for_leg_assembly.jpg[]

It is important that all remaining glue is removed and that the motor holes are clean and even to have the motor best fit into it.

image::remove_remaining_glue_from_servo_hole.jpg[]

Insert hex nut same as before, use a clamp or exress glue.

image::insert_nut_into_knee_pulley.jpg[]

Cut the threading same as before using the hex nut. Test the threading with the 60mm M8 bolt.

image::cut_threading_and_test_bolt.jpg[]

Insert the two thigh motors (hip-pitch and knee pitch), pay attention to mount them in the correct orientation.

image::insert_thigh_motors.jpg[]

Make sure using washers to protect the motors plastic screw holes and wood surface from the turning bolt heads and nuts.

image::use_washers_for_the_motor_bolts.jpg[]

Insert the shank motor, again pay attention to mount it in the correct orientation.

image::insert_shank_motors.jpg[]

Use washers to fill the gap on the inside and a spring washer to tense the bolt.

image::use_spring_washer_for_knee_bolt.jpg[]
image::use_washer_inside.jpg[]

Add a counter locking nut.

image::use_counter_nut_for_locking.jpg[]

Repeat with the second leg following the same procedure. This is result.

image::legs_ready_for_next_step.jpg[]
